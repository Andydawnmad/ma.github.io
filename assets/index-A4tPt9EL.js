import{j as e,r as t,R as $}from"./react-QfoCmFaQ.js";import"./regenerator-runtime-kbts7PMY.js";import{c as G}from"./react-dom-Bfz8IwUc.js";import"./@dotlottie-2i-nfMTP.js";import{T as E,a as N,b as R,c as A,d as F,e as H,f as I}from"./react-icons-DGOjSKsd.js";import{l as Y}from"./react-copy-to-clipboard-DCW82tCm.js";import{B as Z,Q as V}from"./react-toastify-laDfTSLn.js";import{A as O,c as L}from"./react-joyride-D73UQEMR.js";import"./copy-to-clipboard-DnYpVhaB.js";import"./toggle-selection-BHUZwh74.js";import"./scheduler-CzFDRTuY.js";import"./clsx-B-dksMZM.js";import"./@gilbarbara-CQoQLGZn.js";import"./is-lite-Ce_qFKpb.js";import"./tree-changes-fs5NfJf2.js";import"./scroll-IOCIOz97.js";import"./scrollparent-CBWYslax.js";import"./deepmerge-D1tYetAS.js";import"./react-floater-B1ePm3zE.js";import"./prop-types-C7NY0Cvy.js";import"./popper.js-CCzXKaxK.js";import"./react-innertext-QpEmmNc9.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const ee=({candleVisible:i})=>e.jsxs("div",{className:"cake",children:[e.jsx("div",{className:"plate"}),e.jsx("div",{className:"layer layer-bottom"}),e.jsx("div",{className:"layer layer-middle"}),e.jsx("div",{className:"layer layer-top"}),e.jsx("div",{className:"icing"}),e.jsx("div",{className:"drip drip1"}),e.jsx("div",{className:"drip drip2"}),e.jsx("div",{className:"drip drip3"}),e.jsx("div",{id:"candle",className:"candle",children:i?e.jsx("div",{className:"flame"}):null})]}),d={color:"#ffffff",opacity:.9,borderWidth:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#000000"},te=({run:i,start:o,pause:n,stop:l,toggleLightCandle:s,setRun:r,playing:u,paused:p,candleVisible:c})=>{const h=t.useCallback(()=>r(!0),[r]),f=t.useCallback(()=>e.jsxs(e.Fragment,{children:[!u||p?e.jsx("button",{id:"start",style:d,onClick:o,children:e.jsx(E,{})}):null,u&&!p?e.jsx("button",{id:"pause",style:d,onClick:n,children:e.jsx(N,{})}):null,u?e.jsx("button",{id:"stop",style:d,onClick:l,children:e.jsx(R,{})}):null,e.jsx("button",{id:"toggle-candle",style:d,onClick:s,children:c?e.jsx(A,{}):e.jsx(F,{})}),u?null:e.jsx("button",{id:"user-guide",style:d,onClick:h,children:e.jsx(H,{})}),e.jsx(Y.CopyToClipboard,{text:[window.location.href,"shared=true"].join("&"),onCopy:()=>Z("Copied to clipboard!"),children:e.jsx("button",{id:"share",style:d,children:e.jsx(I,{})})})]}),[c,h,n,p,u,o,l,s]),x=t.useCallback(()=>e.jsxs(e.Fragment,{children:[e.jsx("button",{id:"start",style:d,onClick:o,disabled:i,children:e.jsx(E,{})}),e.jsx("button",{id:"pause",style:d,onClick:n,disabled:i,children:e.jsx(N,{})}),e.jsx("button",{id:"stop",style:d,onClick:l,disabled:i,children:e.jsx(R,{})}),e.jsx("button",{id:"toggle-candle",style:d,onClick:s,disabled:i,children:c?e.jsx(A,{}):e.jsx(F,{})}),e.jsx("button",{id:"share",style:d,children:e.jsx(I,{})})]}),[c,n,i,o,l,s]);return e.jsx("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",gap:16,padding:16,height:50},children:i?x():f()})},se=t.forwardRef(({name:i,setName:o,shareMode:n,playing:l,run:s,...r},u)=>{console.log("ðŸš€ ~ playing:",l),console.log("ðŸš€ ~ shareMode:",n);const p=t.useCallback(c=>{o(c.target.value),window.history.pushState({},"",`?name=${c.target.value}`)},[o]);return t.useEffect(()=>{const c=window.location.search,f=new URLSearchParams(c).get("name");f!==null&&o(f)},[o]),e.jsx("div",{style:{position:"absolute",top:"25%",left:"50%",transform:"translateX(-50%)",display:"flex",justifyContent:"center",width:"100dvw",zIndex:40},children:e.jsx("input",{id:"name",ref:u,style:{fontFamily:"Montserrat",fontWeight:"bold",fontSize:"2rem",color:"#f0e4d0",opacity:.9,border:0,outline:0,backgroundColor:"#000000",width:400,...n||l?{appearance:"none",backgroundColor:"transparent",textAlign:"center",display:i.length>0?"block":"none"}:{}},value:i,onChange:p,disabled:n||l||s,readOnly:n||l||s,spellCheck:!1,autoFocus:!0,placeholder:"Enter your name",...r})})}),z=new URL("/ma.github.io/assets/hbd2.mp3",import.meta.url).href,oe=[{target:"#name",content:"This is the input to enter the name.",placement:"bottom",disableBeacon:!0},{target:"#candle",content:"Blow on the Lightning port to extinguish the candle.",placement:"bottom"},{target:"#start",content:"Press start to play music and light the candle.",placement:"top"},{target:"#pause",content:"Press pause if you want the music to pause temporarily.",placement:"top"},{target:"#stop",content:"Press stop if you want to cancel temporarily.",placement:"top"},{target:"#toggle-candle",content:"Press button if you want to light or blow out the candle.",placement:"top"},{target:"#share",content:"Change the name and click 'Share' to send the gift to anyone.",placement:"top"}],re=[{target:"#start",content:"Click here",placement:"top",disableBeacon:!0}];function ne(){const[i,o]=t.useState(!1),n=t.useRef(new Audio(z)),l=t.useRef(void 0),[s,r]=t.useState(!1),[u,p]=t.useState(!1),[c,h]=t.useState(!0),[f,x]=t.useState(!1),[q,M]=t.useState(""),y=t.useRef(null),j=f||s,g=t.useCallback(()=>o(!0),[]),C=t.useCallback(()=>o(!1),[]),U=t.useCallback(()=>o(a=>!a),[]),k=t.useCallback(()=>{r(!0),n.current.load(),n.current.play(),p(!1)},[]),D=t.useCallback(()=>{n.current.pause(),p(!0)},[]),v=t.useCallback(()=>{r(!1),n.current.pause(),n.current.currentTime=0,p(!1)},[]),X=t.useCallback(()=>{k(),g()},[g,k]),K=t.useCallback(()=>{v(),C(),setTimeout(()=>{y.current&&y.current.focus()},0)},[v,C]),w=t.useCallback(async a=>{try{l.current=a;const m=new AudioContext,P=m.createMediaStreamSource(a),b=m.createAnalyser();P.connect(b),b.fftSize=2048;const B=b.frequencyBinCount,T=new Uint8Array(B);setInterval(()=>{b.getByteFrequencyData(T),T.reduce((Q,_)=>Q+_,0)/B>43&&o(!1)},100)}catch(m){console.error("Error accessing microphone:",m)}},[]),S=t.useCallback(a=>{const{action:m}=a;(m===O.RESET||m===O.CLOSE)&&(h(!1),setTimeout(()=>{y.current&&y.current.focus()},0))},[h]),W=t.useCallback(()=>{},[]),J=a=>{a.key==="Enter"&&setTimeout(()=>{y.current&&y.current.blur()},0)};return t.useEffect(()=>((async()=>{try{const a=await navigator.mediaDevices.getUserMedia({audio:!0});a&&w(a)}catch(a){console.error("Error accessing microphone:",a)}})(),()=>{l.current&&l.current.getTracks().forEach(a=>a.stop())}),[w]),t.useLayoutEffect(()=>{const a=window.location.search;new URLSearchParams(a).get("shared")&&(o(!0),x(!0))},[]),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100dvh",justifyContent:"space-between"},children:[e.jsx(L,{styles:{options:{zIndex:f?1e4:-1e4},buttonSkip:{outline:0},buttonNext:{outline:0},buttonBack:{outline:0},buttonClose:{outline:0}},steps:re,run:c,showSkipButton:!0,continuous:!0,callback:S,hideBackButton:!0,hideCloseButton:!0,showProgress:!0,spotlightClicks:!0}),e.jsx(L,{styles:{options:{zIndex:f?-1e4:1e4},buttonSkip:{outline:0},buttonNext:{outline:0},buttonBack:{outline:0},buttonClose:{outline:0}},steps:oe,run:c,showSkipButton:!0,continuous:!0,callback:S,hideBackButton:!0,hideCloseButton:!0,showProgress:!0,spotlightClicks:!0}),e.jsx("audio",{src:z,ref:n,preload:"auto",onEnded:W}),e.jsxs("div",{children:[e.jsx(se,{ref:y,name:q,setName:M,shareMode:f,playing:s,run:c,onKeyPress:J}),e.jsx(ee,{candleVisible:i})]}),e.jsx("div",{style:{position:"absolute",top:0,left:"50%",transform:"translateX(-50%)"},children:e.jsx("dotlottie-player",{src:"/assets/hbd.lottie",autoplay:!0,loop:!0,style:{zIndex:20,visibility:j?"visible":"hidden",width:400}})}),e.jsx("div",{style:{position:"absolute",top:"25%",left:"50%",transform:"translateX(-50%)"},children:e.jsx("dotlottie-player",{src:"/assets/confetti.lottie",autoplay:!0,loop:!0,style:{zIndex:30,visibility:j?"visible":"hidden",width:400}})}),e.jsx("div",{style:{position:"absolute",bottom:"1.25%",left:"50%",transform:"translateX(-50%)"},children:e.jsx(te,{run:c,start:X,pause:D,stop:K,toggleLightCandle:U,setRun:h,playing:s,paused:u,candleVisible:i})})]})}G.createRoot(document.getElementById("root")).render(e.jsxs($.StrictMode,{children:[e.jsx(ne,{}),e.jsx(V,{})]}));
